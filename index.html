<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sean Carroll</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=IBM+Plex+Mono:wght@300;400&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root { --bg: #f5f2ec; --ink: #1a1814; --muted: #7a7570; --rule: #c8c0b4; }

    body {
      background: var(--bg);
      color: var(--ink);
      font-family: 'IBM Plex Mono', monospace;
      font-weight: 300;
      min-height: 100vh;
      padding: 4rem 2rem;
      max-width: 640px;
      margin: 0 auto;
    }

    header {
      display: flex;
      align-items: flex-start;
      gap: 1.8rem;
      margin-bottom: 3.5rem;
      padding-bottom: 2.5rem;
      border-bottom: 1px solid var(--rule);
    }
    header img { width: 68px; height: 68px; border-radius: 50%; filter: grayscale(15%); flex-shrink: 0; }
    .info h1 { font-family: 'IM Fell English', serif; font-size: 1.75rem; font-weight: 400; line-height: 1.1; }
    .info .handle { font-size: 0.7rem; color: var(--muted); letter-spacing: 0.1em; margin-top: 0.3rem; }
    .info .bio { margin-top: 1rem; font-size: 0.77rem; line-height: 1.8; max-width: 440px; }
    .info .org { margin-top: 0.5rem; font-size: 0.7rem; }
    .info .org a { color: var(--muted); text-decoration: none; border-bottom: 1px solid var(--rule); }
    .info .org a:hover { color: var(--ink); border-color: var(--ink); }

    .section-label {
      font-size: 0.65rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 1.5rem;
    }

    .repo { border-top: 1px solid var(--rule); padding: 1.4rem 0; }
    .repo:last-child { border-bottom: 1px solid var(--rule); }
    .repo-header { display: flex; align-items: baseline; justify-content: space-between; gap: 1rem; }
    .repo-name { font-family: 'IM Fell English', serif; font-size: 1.15rem; font-weight: 400; color: var(--ink); text-decoration: none; }
    .repo-name:hover { text-decoration: underline; text-underline-offset: 4px; }
    .repo-lang { font-size: 0.65rem; color: var(--muted); letter-spacing: 0.06em; flex-shrink: 0; }
    .repo-desc { margin-top: 0.35rem; font-size: 0.74rem; color: var(--muted); line-height: 1.65; }

    .file-list { margin-top: 1rem; list-style: none; display: none; }
    .file-list.open { display: block; }
    .file-list li { display: flex; align-items: baseline; gap: 0.5rem; padding: 0.22rem 0; font-size: 0.72rem; }
    .file-list li::before { content: '—'; color: var(--rule); flex-shrink: 0; }
    .file-list a { color: var(--ink); text-decoration: none; }
    .file-list a:hover { text-decoration: underline; text-underline-offset: 3px; }
    .file-list .dir { color: var(--muted); }

    .toggle { margin-top: 0.75rem; font-size: 0.65rem; letter-spacing: 0.08em; color: var(--muted); cursor: pointer; background: none; border: none; font-family: inherit; padding: 0; }
    .toggle:hover { color: var(--ink); }
    .toggle:disabled { opacity: 0.5; cursor: default; }

    .msg { font-size: 0.72rem; color: var(--muted); padding: 0.5rem 0; }
    .err { font-size: 0.72rem; color: #a33; padding: 0.5rem 0; }

    footer { margin-top: 4rem; font-size: 0.62rem; color: var(--rule); letter-spacing: 0.1em; }

    @keyframes fade { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; } }
    .fade { animation: fade 0.5s ease forwards; }
  </style>
</head>
<body>

  <!-- Header populated by JS -->
  <header id="hdr">
    <img id="avatar" src="https://avatars.githubusercontent.com/u/60274196?v=4" alt="Sean Carroll" />
    <div class="info">
      <h1 id="uname">Loading…</h1>
      <p class="handle" id="handle"></p>
      <p class="bio" id="bio"></p>
      <p class="org" id="org"></p>
    </div>
  </header>

  <p class="section-label">Repositories</p>
  <div id="repo-list"><p class="msg">Fetching repositories…</p></div>

  <footer>github.com/seanzshow1</footer>

<script>
const USERNAME = 'seanzshow1';

async function apiFetch(path) {
  const res = await fetch('https://api.github.com' + path, {
    headers: { 'Accept': 'application/vnd.github+json' }
  });
  if (!res.ok) throw new Error(`GitHub API error ${res.status} on ${path}`);
  return res.json();
}

async function loadFiles(repo, fileList, btn) {
  btn.disabled = true;
  btn.textContent = 'loading…';
  try {
    const items = await apiFetch(`/repos/${USERNAME}/${repo}/contents`);
    items.sort((a, b) => {
      if (a.type !== b.type) return a.type === 'dir' ? -1 : 1;
      return a.name.localeCompare(b.name);
    });
    fileList.innerHTML = '';
    items.forEach(item => {
      const li = document.createElement('li');
      if (item.type === 'dir') {
        li.innerHTML = `<span class="dir">${item.name}/</span>`;
      } else {
        li.innerHTML = `<a href="${item.html_url}" target="_blank" rel="noopener">${item.name}</a>`;
      }
      fileList.appendChild(li);
    });
    fileList.classList.add('open');
    btn.textContent = 'hide ↑';
    btn.disabled = false;
    btn.onclick = () => {
      const isOpen = fileList.classList.toggle('open');
      btn.textContent = isOpen ? 'hide ↑' : `files (${items.length}) ↓`;
    };
  } catch(e) {
    btn.textContent = 'error loading files';
    btn.disabled = false;
    console.error(e);
  }
}

async function init() {
  const listEl = document.getElementById('repo-list');

  try {
    // Fetch user + repos in parallel
    const [user, repos] = await Promise.all([
      apiFetch(`/users/${USERNAME}`),
      apiFetch(`/users/${USERNAME}/repos?sort=updated&per_page=100`)
    ]);

    // Fill header
    document.getElementById('avatar').src = user.avatar_url;
    document.getElementById('uname').textContent = user.name || user.login;
    document.getElementById('handle').textContent = `@${user.login}`;
    if (user.bio) document.getElementById('bio').textContent = user.bio;
    if (user.company) {
      const slug = user.company.replace(/^@/, '');
      document.getElementById('org').innerHTML =
        `<a href="https://github.com/${encodeURIComponent(slug)}" target="_blank" rel="noopener">@${slug}</a>`;
    }

    // Fill repos
    const publicRepos = repos.filter(r => !r.private);
    listEl.innerHTML = '';

    if (!publicRepos.length) {
      listEl.innerHTML = '<p class="msg">No public repositories.</p>';
      return;
    }

    publicRepos.forEach(repo => {
      const div = document.createElement('div');
      div.className = 'repo fade';

      const header = document.createElement('div');
      header.className = 'repo-header';

      const nameLink = document.createElement('a');
      nameLink.className = 'repo-name';
      nameLink.href = repo.html_url;
      nameLink.target = '_blank';
      nameLink.rel = 'noopener';
      nameLink.textContent = repo.name;
      header.appendChild(nameLink);

      if (repo.language) {
        const lang = document.createElement('span');
        lang.className = 'repo-lang';
        lang.textContent = repo.language;
        header.appendChild(lang);
      }

      div.appendChild(header);

      if (repo.description) {
        const desc = document.createElement('p');
        desc.className = 'repo-desc';
        desc.textContent = repo.description;
        div.appendChild(desc);
      }

      const fileList = document.createElement('ul');
      fileList.className = 'file-list';

      const btn = document.createElement('button');
      btn.className = 'toggle';
      btn.textContent = 'show files ↓';
      btn.onclick = () => loadFiles(repo.name, fileList, btn);

      div.appendChild(btn);
      div.appendChild(fileList);
      listEl.appendChild(div);
    });

  } catch(e) {
    listEl.innerHTML = `<p class="err">Error: ${e.message}</p><p class="msg" style="margin-top:0.5rem">Open the browser console for details. GitHub API allows 60 requests/hour unauthenticated.</p>`;
    console.error(e);
  }
}

init();
</script>
</body>
</html>
